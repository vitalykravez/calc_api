Сервис-калькулятор.

Запуск локального сервера с сервисом из каталога src: uvicorn main:app --reload

Сервис вычисляет результат арифметического выражения и предоставляет возможность просмотра истории запросов.
В сервисе реализовано 3 конечных точки (endpoints).

1./calc

Post-запрос в формате json на конечную точку /calc осуществляет выполнение арифметических операций в порядке их появления слева направо (арифметический приоритет операций игнорируется)

Пример тела запроса:
{“exp”: “1+1”}

В результате выполнения арифметического выражения в ответе возвращается либо результат выполнения, либо ошибка (некорректность входных данных).

Пример тела ответа:

-без ошибок – {“result”: 2}

-ошибка – {“detail”: “Invalid input data”}

2./history

Конечная точка возвращает последние 30 (по умолчанию) запросов к сервису в формате json (массив), где каждый запрос/ответ имеет вид: 

• Успешно рассчитанный: {"request": "0.01 - 6 * 2", "response": "-11.980", "status": "success"} 

• Запрос с ошибкой: {"request": "5 + - 4", "response": "", "status": "fail"}

Дополнительные параметры запроса (могут использоваться совместно): 

• limit (int) - ограничить количество выводимых запросов; при значениях меньше 1 и больше 30, возвращается ошибка; 

• status (str) - отфильтровать успешные запросы или запросы с ошибкой; допустимые значения: success, fail. При других значениях возвращается ошибка.

Внутреннее хранилище истории ограничено количеством значений по умолчанию (30).

3./docs

В данной конечной точке хранится вся документация сервиса в формате OpenAPI с интерфейсом Swagger.


Замечания автора.

Опыт работы с фреймворком FastAPI пока что небольшой, так что многие аспекты реализации могут показаться, мягко говоря, спорными для человека с опытом и пониманием предмета.  
Вот только некоторые моменты, над которыми еще стоит поработать:

•	Весьма вероятно, что отдельные аспекты задания были неправильно интерпретированы или были некорректно мною поняты. Как следствие, реализация может оказаться неполной или не в полной мере соответствовать задумке автора тестового задания.

•	Весь код и доки были написаны в собственном стиле, выработанном в условиях единоличной и более утилитарной работы с языком Python. Понимаю, что присутствует непаханое поле для рефакторинга и улучшения общего качества кода. 

•	Реализация алгоритма валидации через регулярные выражения представляется далеко не самым оптимальным вариантом. Но, в виду невозможности применения метода eval, никаких других вариантов найдено не было.

•	Реализация выполнена в соответствии с заданием, есть еще много отдельных деталей, способных улучшить качество сервиса (применение оптимального алгоритма валидации и расчета, удобная и подробная документация, применение таких техник, как «польская нотация» и др.)

Но не смотря на все недочеты, в моем понимании считаю задание выполненным на базовом уровне. Охотно приму критику и вообще любой фидбек.

Весь исполняемый код хранится в каталоге src. В нем также присутствует файл requirements.txt, в котором собраны все необходимые для реализации библиотеки.

